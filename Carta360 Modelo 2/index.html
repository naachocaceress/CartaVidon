<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene cursor="rayOrigin: mouse">
      <a-sky src="img/imagen360.jpg"></a-sky>

      <a-entity
        id="instagram"
        position="3 1 0"
        rotation="0 90 0"
        geometry="primitive: box; width: 2; height: 0.5; depth: 0.1"
        material="color: #3498db"
        click-handler="url: https://www.instagram.com/vidonbar; text: Ir a Instagram"
      ></a-entity>

      <!-- Ajustamos la rotación del texto para que sea visible -->
      <a-entity
        id="instagram-text"
        position="2.9 1 0"
        rotation="0 -90 0"
        text="value: Ir a Instagram; color: #ffffff; align: center; width: 6;"
      ></a-entity>

      <a-entity
        id="modal"
        position="0 2 -3"
        geometry="primitive: box; width: 2; height: 0.5; depth: 0.1"
        material="color: tomato"
        click-handler="open-modal: true; text: Click aca"
      ></a-entity>

      <a-entity id="modal-container" visible="false">
        <!-- Aquí define el contenido del modal -->
        <a-box width="3" height="1" depth="0.1" material="color: #fff" position="0 1 -2"></a-box>
        <a-text value="VIDON BAR, El lugar de la buena vida" align="center" color="#000" position="0 1 -1.9"></a-text>
      </a-entity>
    </a-scene>

    <script>
      AFRAME.registerComponent("click-handler", {
        schema: {
          url: { type: "string" },
          text: { type: "string" },
          openModal: { type: "boolean", default: false },
        },
        init: function () {
          const data = this.data;
          const el = this.el;

          // Crear el botón de texto
          const textEl = document.createElement("a-entity");
          textEl.setAttribute("position", "0 0 0.05");
          textEl.setAttribute("text", {
            value: data.text,
            align: "center",
            width: 6,
            color: "#ffffff",
          });
          el.appendChild(textEl);

          el.addEventListener("click", function () {
            if (el.id === "modal" && data.openModal) {
              // Abre el modal solo si el elemento tiene id "modal" y openModal es verdadero
              const modalContainer = document.getElementById("modal-container");
              modalContainer.setAttribute("visible", "true");
            } else {
              // Si no es el botón "modal", abre el enlace en una nueva pestaña
              window.open(data.url, "_blank");
            }
          });
        },
      });
    </script>
  </body>
</html>
